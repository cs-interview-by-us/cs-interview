# 프로세스 vs 스레드
## 프로그램 (Program)
- 파일이 저장 장치에는 저장되어 있지만 메모리에는 올라가 있지 않은 정적인 상태 
- 실행되지 않은 파일 그 자체를 가리킴 
	- ex) 윈도우의 *.exe 파일, MacOS의 *.dmg 파일 

## 프로세스 (Process)
![](README/process.png)
- 운영체제로부터 자원을 할당받은 작업의 단위
- 메모리 상에서 실행 중인 프로그램 인스턴스
- 디스크에 있는 프로그램이 메모리에 loading된 상태 

### 프로세스의 작동 방식
- 운영체제는 프로세스마다 각각 독립된 메모리 영역을 Code/Data/Stack/Heap의 형식으로 할당해줌
- 각각 독립된 메모리 영역을 할당해주기 때문에 프로세스는 다른 프로세스의 변수나 자료에 접근할 수 없음 (접근하기 위해 IPC 통신 필요)

## 스레드 (Thread)
![](README/Thread.png)
- 프로세스가 할당 받은 자원을 이용하는 실행 흐름의 단위
- 프로세스 내에 여러 개 생길 수 있음 

### 스레드의 작동 방식 
- 프로세스마다 최소 1개의 스레드를 가짐 (메인 스레드)
- 각각의 스레드는 별도의 스택을 가지고 있지만 Code/Heap/Data 영역은 공유한다. 

## Context-Switching
- 작업의 주체가 현재 Context를 잠시 중단하고 다른 Context를 실행하는 것
	- 프로세서가 지금까지 실행되던 프로세스(A)를 중지하고 다른 프로세스(B)의 PCB정보를 바탕으로 프로세스(B)를 실행하는 것을 Process Context Switching
	- 동일한 프로세스 속에서 하나의 쓰레드(a)를 중지하고 다른 쓰레드(b)의 TCB정보를 바탕으로 쓰레드 (b)를 실행하는 것을 Thread Context Switching

## 멀티 프로세스
- 하나의 프로그램을 여러 개의 프로세스로 구성하여 각 프로세스가 병렬적으로 작업을 수행하는 것
- 장점
	- 공유하는 자원이 없기 때문에 동일한 자원에 대해 접근하는 일이 없음 
- 단점
	- 각각 독립된 메모리 영역을 갖고 있어 작업량이 많을 수록 오버헤드 발생 및 Context-Switching으로 인한 성능 저하 

## 멀티 스레드
- 하나의 프로세스가 여러 작업을 여러 스레드를 사용하여 동시에 처리하는 것을 의미 
- 장점
	- Context-Switching할 때, 공유하고 있는 메모리만큼 메모리 자원을 아낄 수 있음 
	- 스레드는 프로세스 내의 stack 영역을 제외한 모든 메모리를 공유하기 때문에 통신의 부담이 적어 응답 시간이 빠름 
	- thread의 생성 및 context switching은 process의 생성 및 context switching보다 빠름 
	- 전역 변수와 정적 변수에 대한 자료 공유 가능
- 단점
	- 스레드 하나가 프로세스 내 자원을 망쳐버리면 모든 프로세스가 종료될 수 있음
	- 자원을 공유하기 때문에 동기화 문제 발생할 수 있음 
		- ex) 여러 스레드가 함께 전역 변수를 사용할 경우 발생할 수 있는 충돌 = 동기화 문제 

### 프로세스 Context-Switching과 스레드 Context-Switching 속도 차이 
- 스레드는 프로세스의 자원을 공유하여 사용하고 프로세스가 바뀌지 않는 이상 데이터가 그대로 남아있기 때문에 그대로 가져가서 사용하면 됨 -> 프로세서는 stack 영역의 주소와 thread의 context 정보만 변경하면 됨 
- 프로세스가 변경되게 되면 cache의 정보, 가상 메모리, TLB 등의 정보가 모두 지워지기 때문에 데이터 접근하는데 오래 걸림 (프로세서의 캐싱 메카니즘 때문) 

## 예상 질문
- 왜 멀티스레드 환경에서 하나의 스레드가 프로세스 내 자원을 망쳐버리면 모든 프로세스가 종료가 되나요?
- 프로세스와 스레드의 차이가 무엇인가요?
- Thread-safe한 조건에는 무엇이 있을까요?

### 출처
- [프로세스와 스레드의 차이](https://velog.io/@raejoonee/%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%EC%99%80-%EC%8A%A4%EB%A0%88%EB%93%9C%EC%9D%98-%EC%B0%A8%EC%9D%B4)
- [Thread Context Switching vs Process Context Switching](https://hoony-gunputer.tistory.com/entry/Thread-Context-Switching-vs-Process-Context-Switching)
